<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
            rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
            integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
            crossorigin="anonymous"
    />
    <link href="{{ url_for('static', filename='index.css') }}" rel="stylesheet">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"
    ></script>

    <!-- êµ¬ê¸€í°íŠ¸ -->
    <link
            href="https://fonts.googleapis.com/css?family=Hahmlet:wght@900&Stylish&display=swap"
            rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/paginationjs/2.1.4/pagination.min.js"></script>
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/paginationjs/2.1.4/pagination.css"
    />

    <title>ì¬íŒí•˜ëŠ” ì¡´ê²½ì¥ë‹˜</title>

</head>

<body>
<div class="sign">
    <button onclick="window.location.replace('/login_main')">ë¡œê·¸ì¸</button>
</div>
<div class="container">
    <div class="title">ì¬íŒí•˜ëŠ” ì¡´ê²½ì¥ë‹˜</div>
    <div class="buttons">
        <button
                type="button"
                class="btn btn-light btn-lg btn-block"
                id="getJudge"
                style="border: 1px solid black"
        >
            ì¬íŒë°›ê¸°ğŸ’¦
        </button>
        <button
                type="button"
                class="btn btn-dark btn-lg btn-block"
                id="doJudge"
                style="margin-top: 0px"
        >
            ì¬íŒí•˜ê¸°ğŸ‘¨âš–ï¸
        </button>
    </div>
    <!-- ì¬íŒí•˜ê¸° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ -->
    <div class="list-all">
        <div class="newList">
            <!-- <h3>ì¬íŒ ì¤‘</h3> -->
            <ul class="list-group">
                <div id="pagination"></div>
                <div id="demo"></div>
            </ul>
        </div>
        <div class="bests">
            <button
                    type="button"
                    class="btn btn-light btn-lg btn-block"
                    style="border: 1px solid black"
            >
                ì˜¤ëŠ˜ì˜ ê²©ë¡ ğŸ’¢
            </button>
            <button
                    type="button"
                    class="btn btn-primary btn-lg btn-block"
                    style="margin-top: 0px; border: 1px solid black"
            >
                ì´ë²ˆ ì£¼ì˜ ê²©ë¡ ğŸ’¥
            </button>
        </div>
        <div class="lists">
            <ul class="list-group">
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    ë™ìƒì´ íƒ•ìˆ˜ìœ¡ì„ ìê¾¸ ë¶€ì–´ë¨¹ìŠµë‹ˆë‹¤. ë•Œë ¤ë„ ë¬´ì£„ì¸ê°€ìš”?
                    <span class="badge badge-primary badge-pill">14</span>
                </li>
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    ì•„ëª°ë¼ ì‘ì• 
                    <span class="badge badge-primary badge-pill">2</span>
                </li>
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    êµ­ë°¥ì„ ì‹œì¼°ëŠ”ë° ë°¥ì´ ë§ì•„ì ¸ ë‚˜ì™”ìŠµë‹ˆë‹¤.
                    <span class="badge badge-primary badge-pill">1</span>
                </li>
            </ul>
            <ul class="list-group">
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    ë™ìƒì´ íƒ•ìˆ˜ìœ¡ì„ ìê¾¸ ë¶€ì–´ë¨¹ìŠµë‹ˆë‹¤. ë•Œë ¤ë„ ë¬´ì£„ì¸ê°€ìš”?
                    <span class="badge badge-primary badge-pill">14</span>
                </li>
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    ì£¼ê°„ 2ìœ„
                    <span class="badge badge-primary badge-pill">5</span>
                </li>
                <li
                        class="
                list-group-item
                d-flex
                justify-content-between
                align-items-center
              "
                >
                    ì£¼ê°„ 3ìœ„
                    <span class="badge badge-primary badge-pill">3</span>
                </li>
            </ul>
        </div>
    </div>
    <!-- ì¬íŒë°›ê¸° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ -->
    <div class="post-container">
        <div class="inputs">
            <input class="input-title" placeholder="ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"/>
            <textarea
                    class="input-content"
                    placeholder="ê³ ë¯¼ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
            ></textarea>
        </div>
        <button style="float: right; margin-bottom: 50px" onclick="post()">ì¬íŒ ì ‘ìˆ˜</button>
    </div>
</div>

<script>
    let postList = null;

    //ì¬íŒë°›ê¸°
    $("#doJudge").click(function () {
        $(".list-all").show();
        $(".post-container").hide();
    });

    // ì¬íŒì ‘ìˆ˜
    function post() {
        let title = $(".input-title").val()
        let comment = $(".input-content").val()

        $.ajax({
            type: "POST",
            url: "/post",
            data: {
                title: title,
                content: comment,
                image: ''
            },
            success: function (response) {
                window.location.reload()
            }
        })
    }

    // ì¬íŒí•˜ê¸°
    $("#getJudge").click(function () {
        $(".list-all").hide();
        $(".post-container").show();
    });

    // ê¸€ ëª©ë¡ ë°›ì•„ì˜¤ê¸°
    function getPosts() {

        $("#post-box").empty()
        $.ajax({
            type: "GET",
            url: `/posts`,
            data: {},
            success: function (response) {
                postList = response['posts'];
                console.log(postList)
                // í˜ì´ì§€ë„¤ì´ì…˜
                $("#demo").pagination({
                    pageSize: "7",
                    dataSource: postList.reverse(),
                    callback: function (data, pagination) {
                        var dataHtml = "<div>";

                        $.each(data, function (index, item) {
                            dataHtml +=
                                `<a href="/post?post_id=${item['_id']}">
                                    <li
                                      class="
                                        list-group-item
                                        d-flex
                                        justify-content-between
                                        align-items-center
                                      "
                                    >` +
                                `${item["title"]}` +
                                `<span class="badge badge-primary badge-pill">${item["like"]}</span>
                                </li>
                            </a>`;
                        });

                        dataHtml += "</div>";

                        $("#pagination").html(dataHtml);
                    },
                });
            }
        })
    }

    getPosts();


</script>
</body>
</html>
